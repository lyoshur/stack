<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='springä¸­çš„AOP åŸè¿æ¥åœ°å€ https://www.cnblogs.com/joy99/p/10941543.html ä¸€ã€AOPâ€”â€”å¦ä¸€ç§ç¼–ç¨‹æ€æƒ³ 1.1 ä»€ä¹ˆæ˜¯ AOP AOP ï¼ˆAspect Orient Programmingï¼‰,ç›´è¯‘è¿‡æ¥å°±æ˜¯ é¢å‘åˆ‡é¢ç¼–ç¨‹'><title>springä¸­çš„AOP</title>

<link rel='canonical' href='https://lyoshur.github.io/stack/p/spring%E4%B8%AD%E7%9A%84aop/'>

<link rel="stylesheet" href="/stack/scss/style.min.ac77dcf8b111b51da39a92990f431923f210f3876d85798a2125667f96dc33a4.css"><meta property='og:title' content='springä¸­çš„AOP'>
<meta property='og:description' content='springä¸­çš„AOP åŸè¿æ¥åœ°å€ https://www.cnblogs.com/joy99/p/10941543.html ä¸€ã€AOPâ€”â€”å¦ä¸€ç§ç¼–ç¨‹æ€æƒ³ 1.1 ä»€ä¹ˆæ˜¯ AOP AOP ï¼ˆAspect Orient Programmingï¼‰,ç›´è¯‘è¿‡æ¥å°±æ˜¯ é¢å‘åˆ‡é¢ç¼–ç¨‹'>
<meta property='og:url' content='https://lyoshur.github.io/stack/p/spring%E4%B8%AD%E7%9A%84aop/'>
<meta property='og:site_name' content='ç¾¡é±¼å…ˆç”Ÿçš„ç©ºé—´'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Java' /><meta property='article:published_time' content='2022-08-26T10:41:00&#43;00:00'/><meta property='article:modified_time' content='2022-08-26T10:41:00&#43;00:00'/>
<meta name="twitter:title" content="springä¸­çš„AOP">
<meta name="twitter:description" content="springä¸­çš„AOP åŸè¿æ¥åœ°å€ https://www.cnblogs.com/joy99/p/10941543.html ä¸€ã€AOPâ€”â€”å¦ä¸€ç§ç¼–ç¨‹æ€æƒ³ 1.1 ä»€ä¹ˆæ˜¯ AOP AOP ï¼ˆAspect Orient Programmingï¼‰,ç›´è¯‘è¿‡æ¥å°±æ˜¯ é¢å‘åˆ‡é¢ç¼–ç¨‹">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/stack">
                
                    
                    
                    
                        
                        <img src="/stack/img/avatar_hu2d8583d10845a885ea33cc67231edc4c_47820_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ˜</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/stack">ç¾¡é±¼å…ˆç”Ÿçš„ç©ºé—´</a></h1>
            <h2 class="site-description">æ¥ç»™ç”Ÿæ´»æ‰¾ç‚¹ä¹å­~</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://gitee.com/lyoshur'
                        target="_blank"
                        title="gitee"
                    >
                        
                        
                            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="16px" height="16px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">  <image id="image0" width="16" height="16" x="0" y="0"
    href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABGdBTUEAALGPC/xhBQAAACBjSFJN
AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAdVBMVEUAAADbABjaABTaABPZ
ABT/ACvZABXaABPZABTZABPjSVb2yMz9+Pj////88fLkSlf++/v3y871wcXhPErfLDvdITH++vrj
RVLbDh/cFifhOEb++fnnX2r99vboanXhOUf0t7z1wsb+/f3iPkz99/f2xcniP003qpK8AAAACXRS
TlMAK4/V8waU/b0v8seaAAAAAWJLR0QN9rRh9QAAAAd0SU1FB+YICAUFOzO67psAAACKSURBVBjT
ZY9ZEsIwDEMdJ00qqEvZy1qgwP2PiJ0CM9D3Z83IkogUxz4Ez44GipiQSbHId4kvpSkRmEwrMWpE
9SfM5E2D5IiBuSyWK2MNMHlgI1u0O6UFPAVAZI+DWSog/Ahigh8EtRzlZBY24awfu4tc7anGflJv
vcVqsTqf98cTVmxcfTTub/4LPbIKJ1fQ5EgAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjItMDgtMDhU
MDU6MDU6NTkrMDA6MDB+AB5YAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIyLTA4LTA4VDA1OjA1OjU5
KzAwOjAwD12m5AAAAABJRU5ErkJggg==" />
</svg>

                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/stack/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        

        <li >
            <a href='/stack/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>ç¬”è®°æœ¬</span>
            </a>
        </li>
        
        

        <li >
            <a href='/stack/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        

        <li >
            <a href='/stack/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>æš—è‰²æ¨¡å¼</span>
                </li>
            
        </div>
    </ol>
</aside>
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/stack/categories/java/" style="background-color: #2a9d8f; color: #fff;">
                JAVA
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/stack/p/spring%E4%B8%AD%E7%9A%84aop/">springä¸­çš„AOP</a>
        </h2>
    
        
    </div>

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2022-08-26 10:41:00</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 13 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>
</header>

    <section class="article-content">
    
    
    <h1 id="springä¸­çš„aop">springä¸­çš„AOP</h1>
<p>åŸè¿æ¥åœ°å€ <a class="link" href="https://www.cnblogs.com/joy99/p/10941543.html"  target="_blank" rel="noopener"
    >https://www.cnblogs.com/joy99/p/10941543.html</a></p>
<h1 id="ä¸€aopå¦ä¸€ç§ç¼–ç¨‹æ€æƒ³">ä¸€ã€AOPâ€”â€”å¦ä¸€ç§ç¼–ç¨‹æ€æƒ³</h1>
<h2 id="11-ä»€ä¹ˆæ˜¯-aop">1.1 ä»€ä¹ˆæ˜¯ AOP</h2>
<p>AOP ï¼ˆAspect Orient Programmingï¼‰,ç›´è¯‘è¿‡æ¥å°±æ˜¯ é¢å‘åˆ‡é¢ç¼–ç¨‹ã€‚AOP æ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰çš„ä¸€ç§è¡¥å……ã€‚é¢å‘å¯¹è±¡ç¼–ç¨‹å°†ç¨‹åºæŠ½è±¡æˆå„ä¸ªå±‚æ¬¡çš„å¯¹è±¡ï¼Œè€Œé¢å‘åˆ‡é¢ç¼–ç¨‹æ˜¯å°†ç¨‹åºæŠ½è±¡æˆå„ä¸ªåˆ‡é¢ã€‚
ä»ã€ŠSpringå®æˆ˜ï¼ˆç¬¬4ç‰ˆï¼‰ã€‹å›¾ä¹¦ä¸­æ‰’äº†ä¸€å¼ å›¾ï¼š
<img src="https://img2018.cnblogs.com/blog/758949/201905/758949-20190529225344641-152289598.png"
	
	
	
	loading="lazy"
	
		alt="img"
	
	
></p>
<p>ä»è¯¥å›¾å¯ä»¥å¾ˆå½¢è±¡åœ°çœ‹å‡ºï¼Œæ‰€è°“åˆ‡é¢ï¼Œç›¸å½“äºåº”ç”¨å¯¹è±¡é—´çš„æ¨ªåˆ‡ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶å•ç‹¬æŠ½è±¡ä¸ºå•ç‹¬çš„æ¨¡å—ã€‚</p>
<h2 id="12-ä¸ºä»€ä¹ˆéœ€è¦-aop">1.2 ä¸ºä»€ä¹ˆéœ€è¦ AOP</h2>
<p>æƒ³è±¡ä¸‹é¢çš„åœºæ™¯ï¼Œå¼€å‘ä¸­åœ¨å¤šä¸ªæ¨¡å—é—´æœ‰æŸæ®µé‡å¤çš„ä»£ç ï¼Œæˆ‘ä»¬é€šå¸¸æ˜¯æ€ä¹ˆå¤„ç†çš„ï¼Ÿæ˜¾ç„¶ï¼Œæ²¡æœ‰äººä¼šé â€œå¤åˆ¶ç²˜è´´â€å§ã€‚åœ¨ä¼ ç»Ÿçš„é¢å‘è¿‡ç¨‹ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå°†è¿™æ®µä»£ç ï¼ŒæŠ½è±¡æˆä¸€ä¸ªæ–¹æ³•ï¼Œç„¶ååœ¨éœ€è¦çš„åœ°æ–¹åˆ†åˆ«è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè¿™æ ·å½“è¿™æ®µä»£ç éœ€è¦ä¿®æ”¹æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦æ”¹å˜è¿™ä¸ªæ–¹æ³•å°±å¯ä»¥äº†ã€‚ç„¶è€Œéœ€æ±‚æ€»æ˜¯å˜åŒ–çš„ï¼Œæœ‰ä¸€å¤©ï¼Œæ–°å¢äº†ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦å†å¤šå‡ºåšä¿®æ”¹ï¼Œæˆ‘ä»¬éœ€è¦å†æŠ½è±¡å‡ºä¸€ä¸ªæ–¹æ³•ï¼Œç„¶åå†åœ¨éœ€è¦çš„åœ°æ–¹åˆ†åˆ«è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œåˆæˆ–è€…æˆ‘ä»¬ä¸éœ€è¦è¿™ä¸ªæ–¹æ³•äº†ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾—åˆ é™¤æ‰æ¯ä¸€å¤„è°ƒç”¨è¯¥æ–¹æ³•çš„åœ°æ–¹ã€‚å®é™…ä¸Šæ¶‰åŠåˆ°å¤šä¸ªåœ°æ–¹å…·æœ‰ç›¸åŒçš„ä¿®æ”¹çš„é—®é¢˜æˆ‘ä»¬éƒ½å¯ä»¥é€šè¿‡ AOP æ¥è§£å†³ã€‚</p>
<h2 id="13-aop-å®ç°åˆ†ç±»">1.3 AOP å®ç°åˆ†ç±»</h2>
<p>AOP è¦è¾¾åˆ°çš„æ•ˆæœæ˜¯ï¼Œä¿è¯å¼€å‘è€…ä¸ä¿®æ”¹æºä»£ç çš„å‰æä¸‹ï¼Œå»ä¸ºç³»ç»Ÿä¸­çš„ä¸šåŠ¡ç»„ä»¶æ·»åŠ æŸç§é€šç”¨åŠŸèƒ½ã€‚AOP çš„æœ¬è´¨æ˜¯ç”± AOP æ¡†æ¶ä¿®æ”¹ä¸šåŠ¡ç»„ä»¶çš„å¤šä¸ªæ–¹æ³•çš„æºä»£ç ï¼Œçœ‹åˆ°è¿™å…¶å®åº”è¯¥æ˜ç™½äº†ï¼ŒAOP å…¶å®å°±æ˜¯å‰é¢ä¸€ç¯‡æ–‡ç« è®²çš„ä»£ç†æ¨¡å¼çš„å…¸å‹åº”ç”¨ã€‚
æŒ‰ç…§ AOP æ¡†æ¶ä¿®æ”¹æºä»£ç çš„æ—¶æœºï¼Œå¯ä»¥å°†å…¶åˆ†ä¸ºä¸¤ç±»ï¼š</p>
<ul>
<li>é™æ€ AOP å®ç°ï¼Œ AOP æ¡†æ¶åœ¨ç¼–è¯‘é˜¶æ®µå¯¹ç¨‹åºæºä»£ç è¿›è¡Œä¿®æ”¹ï¼Œç”Ÿæˆäº†é™æ€çš„ AOP ä»£ç†ç±»ï¼ˆç”Ÿæˆçš„ *.class æ–‡ä»¶å·²ç»è¢«æ”¹æ‰äº†ï¼Œéœ€è¦ä½¿ç”¨ç‰¹å®šçš„ç¼–è¯‘å™¨ï¼‰ï¼Œæ¯”å¦‚ AspectJã€‚</li>
<li>åŠ¨æ€ AOP å®ç°ï¼Œ AOP æ¡†æ¶åœ¨è¿è¡Œé˜¶æ®µå¯¹åŠ¨æ€ç”Ÿæˆä»£ç†å¯¹è±¡ï¼ˆåœ¨å†…å­˜ä¸­ä»¥ JDK åŠ¨æ€ä»£ç†ï¼Œæˆ– CGlib åŠ¨æ€åœ°ç”Ÿæˆ AOP ä»£ç†ç±»ï¼‰ï¼Œå¦‚ SpringAOPã€‚</li>
</ul>
<p>ä¸‹é¢ç»™å‡ºå¸¸ç”¨ AOP å®ç°æ¯”è¾ƒ
<img src="https://img2018.cnblogs.com/blog/758949/201905/758949-20190529225400887-1590896890.png"
	
	
	
	loading="lazy"
	
		alt="img"
	
	
></p>
<p>å¦‚ä¸æ¸…æ¥šåŠ¨æ€ä»£ç†çš„ï¼Œå¯å‚è€ƒæˆ‘å‰é¢çš„ä¸€ç¯‡æ–‡ç« ï¼Œæœ‰è®²è§£é™æ€ä»£ç†ã€JDKåŠ¨æ€ä»£ç†å’Œ CGlib åŠ¨æ€ä»£ç†ã€‚
<a class="link" href="https://www.cnblogs.com/joy99/p/10865391.html"  target="_blank" rel="noopener"
    >é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç† https://www.cnblogs.com/joy99/p/10865391.html</a></p>
<h1 id="äºŒaop-æœ¯è¯­">äºŒã€AOP æœ¯è¯­</h1>
<p>AOP é¢†åŸŸä¸­çš„ç‰¹æ€§æœ¯è¯­ï¼š</p>
<ul>
<li>é€šçŸ¥ï¼ˆAdviceï¼‰: AOP æ¡†æ¶ä¸­çš„å¢å¼ºå¤„ç†ã€‚é€šçŸ¥æè¿°äº†åˆ‡é¢ä½•æ—¶æ‰§è¡Œä»¥åŠå¦‚ä½•æ‰§è¡Œå¢å¼ºå¤„ç†ã€‚</li>
<li>è¿æ¥ç‚¹ï¼ˆjoin pointï¼‰: è¿æ¥ç‚¹è¡¨ç¤ºåº”ç”¨æ‰§è¡Œè¿‡ç¨‹ä¸­èƒ½å¤Ÿæ’å…¥åˆ‡é¢çš„ä¸€ä¸ªç‚¹ï¼Œè¿™ä¸ªç‚¹å¯ä»¥æ˜¯æ–¹æ³•çš„è°ƒç”¨ã€å¼‚å¸¸çš„æŠ›å‡ºã€‚åœ¨ Spring AOP ä¸­ï¼Œè¿æ¥ç‚¹æ€»æ˜¯æ–¹æ³•çš„è°ƒç”¨ã€‚</li>
<li>åˆ‡ç‚¹ï¼ˆPointCutï¼‰: å¯ä»¥æ’å…¥å¢å¼ºå¤„ç†çš„è¿æ¥ç‚¹ã€‚</li>
<li>åˆ‡é¢ï¼ˆAspectï¼‰: åˆ‡é¢æ˜¯é€šçŸ¥å’Œåˆ‡ç‚¹çš„ç»“åˆã€‚</li>
<li>å¼•å…¥ï¼ˆIntroductionï¼‰ï¼šå¼•å…¥å…è®¸æˆ‘ä»¬å‘ç°æœ‰çš„ç±»æ·»åŠ æ–°çš„æ–¹æ³•æˆ–è€…å±æ€§ã€‚</li>
<li>ç»‡å…¥ï¼ˆWeavingï¼‰: å°†å¢å¼ºå¤„ç†æ·»åŠ åˆ°ç›®æ ‡å¯¹è±¡ä¸­ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªè¢«å¢å¼ºçš„å¯¹è±¡ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ç»‡å…¥ã€‚</li>
</ul>
<p>æ¦‚å¿µçœ‹èµ·æ¥æ€»æ˜¯æœ‰ç‚¹æ‡µï¼Œå¹¶ä¸”ä¸Šè¿°æœ¯è¯­ï¼Œä¸åŒçš„å‚è€ƒä¹¦ç±ä¸Šç¿»è¯‘è¿˜ä¸ä¸€æ ·ï¼Œæ‰€ä»¥éœ€è¦æ…¢æ…¢åœ¨åº”ç”¨ä¸­ç†è§£ã€‚</p>
<h1 id="ä¸‰åˆæ­¥è®¤è¯†-spring-aop">ä¸‰ã€åˆæ­¥è®¤è¯† Spring AOP</h1>
<h2 id="31-spring-aop-çš„ç‰¹ç‚¹">3.1 Spring AOP çš„ç‰¹ç‚¹</h2>
<p>AOP æ¡†æ¶æœ‰å¾ˆå¤šç§ï¼Œ1.3èŠ‚ä¸­ä»‹ç»äº† AOP æ¡†æ¶çš„å®ç°æ–¹å¼æœ‰å¯èƒ½ä¸åŒï¼Œ Spring ä¸­çš„ AOP æ˜¯é€šè¿‡åŠ¨æ€ä»£ç†å®ç°çš„ã€‚ä¸åŒçš„ AOP æ¡†æ¶æ”¯æŒçš„è¿æ¥ç‚¹ä¹Ÿæœ‰æ‰€åŒºåˆ«ï¼Œä¾‹å¦‚ï¼ŒAspectJ å’Œ JBoss,é™¤äº†æ”¯æŒæ–¹æ³•åˆ‡ç‚¹ï¼Œå®ƒä»¬è¿˜æ”¯æŒå­—æ®µå’Œæ„é€ å™¨çš„è¿æ¥ç‚¹ã€‚è€Œ Spring AOP ä¸èƒ½æ‹¦æˆªå¯¹å¯¹è±¡å­—æ®µçš„ä¿®æ”¹ï¼Œä¹Ÿä¸æ”¯æŒæ„é€ å™¨è¿æ¥ç‚¹,æˆ‘ä»¬æ— æ³•åœ¨ Bean åˆ›å»ºæ—¶åº”ç”¨é€šçŸ¥ã€‚</p>
<h2 id="32-spring-aop-çš„ç®€å•ä¾‹å­">3.2 Spring AOP çš„ç®€å•ä¾‹å­</h2>
<p>ä¸‹é¢å…ˆä¸Šä»£ç ï¼Œå¯¹ç€ä»£ç è¯´æ¯”è¾ƒå¥½è¯´ï¼Œçœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š
è¿™ä¸ªä¾‹å­æ˜¯åŸºäºgradleåˆ›å»ºçš„ï¼Œé¦–å…ˆ build.gradle æ–‡ä»¶æ·»åŠ ä¾èµ–ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">dependencies</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">compile</span> <span class="s1">&#39;org.springframework:spring-context:5.0.6.RELEASE&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ¥å£ IBuy.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="n">package</span> <span class="n">com</span><span class="p">.</span><span class="n">sharpcj</span><span class="p">.</span><span class="n">aopdemo</span><span class="p">.</span><span class="n">test1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">interface</span> <span class="nc">IBuy</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="n">buy</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Boy å’Œ Gril ä¸¤ä¸ªç±»åˆ†åˆ«å®ç°äº†è¿™ä¸ªæ¥å£ï¼š
Boy.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">package</span> <span class="nx">com</span><span class="p">.</span><span class="nx">sharpcj</span><span class="p">.</span><span class="nx">aopdemo</span><span class="p">.</span><span class="nx">test1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">org</span><span class="p">.</span><span class="nx">springframework</span><span class="p">.</span><span class="nx">stereotype</span><span class="p">.</span><span class="nx">Component</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="kr">public</span> <span class="kr">class</span> <span class="nx">Boy</span> <span class="kr">implements</span> <span class="nx">IBuy</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kr">public</span> <span class="nb">String</span> <span class="nx">buy() {</span>
</span></span><span class="line"><span class="cl">        <span class="nx">System</span><span class="p">.</span><span class="nx">out</span><span class="p">.</span><span class="nx">println</span><span class="p">(</span><span class="s2">&#34;ç”·å­©ä¹°äº†ä¸€ä¸ªæ¸¸æˆæœº&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;æ¸¸æˆæœº&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Girl.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">package</span> <span class="nx">com</span><span class="p">.</span><span class="nx">sharpcj</span><span class="p">.</span><span class="nx">aopdemo</span><span class="p">.</span><span class="nx">test1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">org</span><span class="p">.</span><span class="nx">springframework</span><span class="p">.</span><span class="nx">stereotype</span><span class="p">.</span><span class="nx">Component</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="kr">public</span> <span class="kr">class</span> <span class="nx">Girl</span> <span class="kr">implements</span> <span class="nx">IBuy</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kr">public</span> <span class="nb">String</span> <span class="nx">buy() {</span>
</span></span><span class="line"><span class="cl">        <span class="nx">System</span><span class="p">.</span><span class="nx">out</span><span class="p">.</span><span class="nx">println</span><span class="p">(</span><span class="s2">&#34;å¥³å­©ä¹°äº†ä¸€ä»¶æ¼‚äº®çš„è¡£æœ&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;è¡£æœ&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é…ç½®æ–‡ä»¶, AppConfig.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="k">package</span> <span class="nn">com.sharpcj.aopdemo;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">import</span> <span class="nn">org.springframework.context.annotation.ComponentScan;</span>
</span></span><span class="line"><span class="cl"><span class="k">import</span> <span class="nn">org.springframework.context.annotation.Configuration;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="nd">@ComponentScan</span><span class="p">(</span><span class="n">basePackageClasses</span> <span class="p">=</span> <span class="p">{</span><span class="n">com</span><span class="p">.</span><span class="n">sharpcj</span><span class="p">.</span><span class="n">aopdemo</span><span class="p">.</span><span class="n">test1</span><span class="p">.</span><span class="n">IBuy</span><span class="p">.</span><span class="k">class</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">AppConfig</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æµ‹è¯•ç±»ï¼Œ AppTest.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.sharpcj.aopdemo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.sharpcj.aopdemo.test1.Boy</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.sharpcj.aopdemo.test1.Girl</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.context.annotation.AnnotationConfigApplicationContext</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppTest</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">AnnotationConfigApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="n">AppConfig</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Boy</span> <span class="n">boy</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;boy&#34;</span><span class="o">,</span><span class="n">Boy</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Girl</span> <span class="n">girl</span> <span class="o">=</span> <span class="o">(</span><span class="n">Girl</span><span class="o">)</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;girl&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">boy</span><span class="o">.</span><span class="na">buy</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">girl</span><span class="o">.</span><span class="na">buy</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿è¡Œç»“æœï¼š
<img src="https://img2018.cnblogs.com/blog/758949/201905/758949-20190529225425832-1733905596.png"
	
	
	
	loading="lazy"
	
		alt="img"
	
	
></p>
<p>è¿™é‡Œè¿ç”¨SpringIOCé‡Œçš„è‡ªåŠ¨éƒ¨ç½²ã€‚ç°åœ¨éœ€æ±‚æ”¹å˜äº†ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç”·å­©å’Œå¥³å­©çš„ buy æ–¹æ³•ä¹‹å‰ï¼Œéœ€è¦æ‰“å°å‡ºâ€œç”·å­©å¥³å­©éƒ½ä¹°äº†è‡ªå·±å–œæ¬¢çš„ä¸œè¥¿â€ã€‚ç”¨ Spring AOP æ¥å®ç°è¿™ä¸ªéœ€æ±‚åªéœ€ä¸‹é¢å‡ ä¸ªæ­¥éª¤ï¼š
1ã€ <strong>æ—¢ç„¶ç”¨åˆ° Spring AOP, é¦–å…ˆåœ¨ <code>build.gralde</code> æ–‡ä»¶ä¸­å¼•å…¥ç›¸å…³ä¾èµ–ï¼š</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">dependencies</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">compile</span> <span class="s1">&#39;org.springframework:spring-context:5.0.6.RELEASE&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">compile</span> <span class="s1">&#39;org.springframework:spring-aspects:5.0.6.RELEASE&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>2ã€ <strong>å®šä¹‰ä¸€ä¸ªåˆ‡é¢ç±»ï¼ŒBuyAspectJ.java</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.sharpcj.aopdemo.test1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.aspectj.lang.annotation.Aspect</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.aspectj.lang.annotation.Before</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Aspect</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BuyAspectJ</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Before</span><span class="o">(</span><span class="s">&#34;execution(* com.sharpcj.aopdemo.test1.IBuy.buy(..))&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">haha</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;ç”·å­©å¥³å­©éƒ½ä¹°è‡ªå·±å–œæ¬¢çš„ä¸œè¥¿&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªç±»ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æ³¨è§£ <code>@Component</code> è¡¨æ˜å®ƒå°†ä½œä¸ºä¸€ä¸ªSpring Bean è¢«è£…é…ï¼Œä½¿ç”¨æ³¨è§£ <code>@Aspect</code> è¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªåˆ‡é¢ã€‚
ç±»ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³• <code>haha</code> æˆ‘ä»¬ä½¿ç”¨ <code>@Before</code> è¿™ä¸ªæ³¨è§£ï¼Œè¡¨ç¤ºä»–å°†åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œã€‚å…³äºè¿™ä¸ªæ³¨è§£åæ–‡å†ä½œè§£é‡Šã€‚
å‚æ•°<code>(&quot;execution(* com.sharpcj.aopdemo.test1.IBuy.buy(..))&quot;)</code> å£°æ˜äº†åˆ‡ç‚¹ï¼Œè¡¨æ˜åœ¨è¯¥åˆ‡é¢çš„åˆ‡ç‚¹æ˜¯<code>com.sharpcj.aopdemo.test1.Ibuy</code>è¿™ä¸ªæ¥å£ä¸­çš„<code>buy</code>æ–¹æ³•ã€‚è‡³äºä¸ºä»€ä¹ˆè¿™ä¹ˆå†™ï¼Œä¸‹æ–‡å†è§£é‡Šã€‚
3ã€ <strong>åœ¨é…ç½®æ–‡ä»¶ä¸­å¯ç”¨AOPåˆ‡é¢åŠŸèƒ½</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="k">package</span> <span class="nn">com.sharpcj.aopdemo;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">import</span> <span class="nn">org.springframework.context.annotation.ComponentScan;</span>
</span></span><span class="line"><span class="cl"><span class="k">import</span> <span class="nn">org.springframework.context.annotation.Configuration;</span>
</span></span><span class="line"><span class="cl"><span class="k">import</span> <span class="nn">org.springframework.context.annotation.EnableAspectJAutoProxy;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="nd">@ComponentScan</span><span class="p">(</span><span class="n">basePackageClasses</span> <span class="p">=</span> <span class="p">{</span><span class="n">com</span><span class="p">.</span><span class="n">sharpcj</span><span class="p">.</span><span class="n">aopdemo</span><span class="p">.</span><span class="n">test1</span><span class="p">.</span><span class="n">IBuy</span><span class="p">.</span><span class="k">class</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="nd">@EnableAspectJAutoProxy</span><span class="p">(</span><span class="n">proxyTargetClass</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">AppConfig</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ç±»å¢åŠ äº†<code>@EnableAspectJAutoProxy</code>æ³¨è§£ï¼Œå¯ç”¨äº† AOP åŠŸèƒ½ï¼Œå‚æ•°<code>proxyTargetClass</code>çš„å€¼è®¾ä¸ºäº† true ã€‚é»˜è®¤å€¼æ˜¯ falseï¼Œä¸¤è€…çš„åŒºåˆ«ä¸‹æ–‡å†è§£é‡Šã€‚
OKï¼Œä¸‹é¢åªéœ€æµ‹è¯•ä»£ç ,è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
<img src="https://img2018.cnblogs.com/blog/758949/201905/758949-20190529225446321-1741506938.png"
	
	
	
	loading="lazy"
	
		alt="img"
	
	
></p>
<p>æˆ‘ä»¬çœ‹åˆ°ï¼Œç»“æœä¸æˆ‘ä»¬éœ€æ±‚ä¸€è‡´ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ä¿®æ”¹ Boy å’Œ Girl ç±»çš„ Buy æ–¹æ³•ï¼Œä¹Ÿæ²¡æœ‰ä¿®æ”¹æµ‹è¯•ç±»çš„ä»£ç ï¼Œå‡ ä¹æ˜¯å®Œå…¨æ— ä¾µå…¥å¼åœ°å®ç°äº†éœ€æ±‚ã€‚è¿™å°±æ˜¯ AOP çš„â€œç¥å¥‡â€ä¹‹å¤„ã€‚</p>
<h1 id="å››é€šè¿‡æ³¨è§£é…ç½®-spring-aop">å››ã€é€šè¿‡æ³¨è§£é…ç½® Spring AOP</h1>
<h2 id="41-é€šè¿‡æ³¨è§£å£°æ˜åˆ‡ç‚¹æŒ‡ç¤ºå™¨">4.1 é€šè¿‡æ³¨è§£å£°æ˜åˆ‡ç‚¹æŒ‡ç¤ºå™¨</h2>
<p>Spring AOP æ‰€æ”¯æŒçš„ AspectJ åˆ‡ç‚¹æŒ‡ç¤ºå™¨
<img src="https://img2018.cnblogs.com/blog/758949/201905/758949-20190529225507103-314276426.png"
	
	
	
	loading="lazy"
	
		alt="img"
	
	
>
åœ¨springä¸­å°è¯•ä½¿ç”¨AspectJå…¶ä»–æŒ‡ç¤ºå™¨æ—¶ï¼Œå°†ä¼šæŠ›å‡ºIllegalArgumentExceptionå¼‚å¸¸ã€‚</p>
<p>å½“æˆ‘ä»¬æŸ¥çœ‹ä¸Šé¢å±•ç¤ºçš„è¿™äº›springæ”¯æŒçš„æŒ‡ç¤ºå™¨æ—¶ï¼Œæ³¨æ„åªæœ‰executionæŒ‡ç¤ºå™¨æ˜¯å”¯ä¸€çš„æ‰§è¡ŒåŒ¹é…ï¼Œè€Œå…¶ä»–çš„æŒ‡ç¤ºå™¨éƒ½æ˜¯ç”¨äºé™åˆ¶åŒ¹é…çš„ã€‚è¿™è¯´æ˜executionæŒ‡ç¤ºå™¨æ˜¯æˆ‘ä»¬åœ¨ç¼–å†™åˆ‡ç‚¹å®šä¹‰æ—¶æœ€ä¸»è¦ä½¿ç”¨çš„æŒ‡ç¤ºå™¨ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨å…¶ä»–æŒ‡ç¤ºå™¨æ¥é™åˆ¶æ‰€åŒ¹é…çš„åˆ‡ç‚¹ã€‚</p>
<p>ä¸‹å›¾çš„åˆ‡ç‚¹è¡¨è¾¾å¼è¡¨ç¤ºå½“Instrumentçš„playæ–¹æ³•æ‰§è¡Œæ—¶ä¼šè§¦å‘é€šçŸ¥ã€‚
<img src="https://img2018.cnblogs.com/blog/758949/201905/758949-20190529225530124-1714809272.png"
	
	
	
	loading="lazy"
	
		alt="img"
	
	
>
æˆ‘ä»¬ä½¿ç”¨executionæŒ‡ç¤ºå™¨é€‰æ‹©Instrumentçš„playæ–¹æ³•ï¼Œæ–¹æ³•è¡¨è¾¾å¼ä»¥ <code>*</code> å·å¼€å§‹ï¼Œæ ‡è¯†æˆ‘ä»¬ä¸å…³å¿ƒæ–¹æ³•çš„è¿”å›å€¼ç±»å‹ã€‚ç„¶åæˆ‘ä»¬æŒ‡å®šäº†å…¨é™å®šç±»åå’Œæ–¹æ³•åã€‚å¯¹äºæ–¹æ³•å‚æ•°åˆ—è¡¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>..</code> æ ‡è¯†åˆ‡ç‚¹é€‰æ‹©ä»»æ„çš„playæ–¹æ³•ï¼Œæ— è®ºè¯¥æ–¹æ³•çš„å…¥å‚æ˜¯ä»€ä¹ˆã€‚
å¤šä¸ªåŒ¹é…ä¹‹é—´æˆ‘ä»¬å¯ä»¥ä½¿ç”¨é“¾æ¥ç¬¦ <code>&amp;&amp;</code>ã€<code>||</code>ã€<code>ï¼</code>æ¥è¡¨ç¤º â€œä¸”â€ã€â€œæˆ–â€ã€â€œéâ€çš„å…³ç³»ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨ XML æ–‡ä»¶é…ç½®æ—¶ï¼Œè¿™äº›ç¬¦å·æœ‰ç‰¹æ®Šçš„å«ä¹‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ â€œandâ€ã€â€œorâ€ã€â€œnotâ€æ¥è¡¨ç¤ºã€‚</p>
<p>ä¸¾ä¾‹ï¼š
é™å®šè¯¥åˆ‡ç‚¹ä»…åŒ¹é…çš„åŒ…æ˜¯ <code>com.sharpcj.aopdemo.test1</code>,å¯ä»¥ä½¿ç”¨
<code>execution(* com.sharpcj.aopdemo.test1.IBuy.buy(..)) &amp;&amp; within(com.sharpcj.aopdemo.test1.*)</code>
åœ¨åˆ‡ç‚¹ä¸­é€‰æ‹© bean,å¯ä»¥ä½¿ç”¨
<code>execution(* com.sharpcj.aopdemo.test1.IBuy.buy(..)) &amp;&amp; bean(girl)</code>
ä¿®æ”¹ BuyAspectJ.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.sharpcj.aopdemo.test1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.aspectj.lang.annotation.Aspect</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.aspectj.lang.annotation.Before</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Aspect</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BuyAspectJ</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Before</span><span class="o">(</span><span class="s">&#34;execution(* com.sharpcj.aopdemo.test1.IBuy.buy(..)) &amp;&amp; within(com.sharpcj.aopdemo.test1.*) &amp;&amp; bean(girl)&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hehe</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;ç”·å­©å¥³å­©éƒ½ä¹°è‡ªå·±å–œæ¬¢çš„ä¸œè¥¿&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ­¤æ—¶ï¼Œåˆ‡é¢åªä¼šå¯¹ <code>Girl.java</code> è¿™ä¸ªç±»ç”Ÿæ•ˆï¼Œæ‰§è¡Œç»“æœï¼š
<img src="https://img2018.cnblogs.com/blog/758949/201905/758949-20190529225548745-1785519580.png"
	
	
	
	loading="lazy"
	
		alt="img"
	
	
></p>
<p>ç»†å¿ƒçš„ä½ ï¼Œå¯èƒ½å‘ç°äº†ï¼Œåˆ‡é¢ä¸­çš„æ–¹æ³•åï¼Œå·²ç»è¢«æˆ‘æ‚„æ‚„åœ°ä»<code>haha</code>æ”¹æˆäº†<code>hehe</code>ï¼Œä¸æ¯«æ²¡æœ‰å½±å“ç»“æœï¼Œè¯´æ˜æ–¹æ³•åæ²¡æœ‰å½±å“ã€‚å’Œ Spring IOC ä¸­ç”¨ java é…ç½®æ–‡ä»¶è£…é… Bean æ—¶ï¼Œç”¨<code>@Bean</code> æ³¨è§£ä¿®é¥°çš„æ–¹æ³•åä¸€æ ·ï¼Œæ²¡æœ‰å½±å“ã€‚</p>
<h2 id="42-é€šè¿‡æ³¨è§£å£°æ˜-5-ç§é€šçŸ¥ç±»å‹">4.2 é€šè¿‡æ³¨è§£å£°æ˜ 5 ç§é€šçŸ¥ç±»å‹</h2>
<p>Spring AOP ä¸­æœ‰ 5 ä¸­é€šçŸ¥ç±»å‹ï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š
<img src="https://img2018.cnblogs.com/blog/758949/201905/758949-20190529225613898-1522094074.png"
	
	
	
	loading="lazy"
	
		alt="img"
	
	
></p>
<p>ä¸‹é¢ä¿®æ”¹åˆ‡é¢ç±»ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.sharpcj.aopdemo.test1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.aspectj.lang.ProceedingJoinPoint</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.aspectj.lang.annotation.*</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Aspect</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BuyAspectJ</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Before</span><span class="o">(</span><span class="s">&#34;execution(* com.sharpcj.aopdemo.test1.IBuy.buy(..))&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hehe</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;before ...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@After</span><span class="o">(</span><span class="s">&#34;execution(* com.sharpcj.aopdemo.test1.IBuy.buy(..))&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">haha</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;After ...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@AfterReturning</span><span class="o">(</span><span class="s">&#34;execution(* com.sharpcj.aopdemo.test1.IBuy.buy(..))&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">xixi</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;AfterReturning ...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Around</span><span class="o">(</span><span class="s">&#34;execution(* com.sharpcj.aopdemo.test1.IBuy.buy(..))&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">xxx</span><span class="o">(</span><span class="n">ProceedingJoinPoint</span> <span class="n">pj</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Around aaa ...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">pj</span><span class="o">.</span><span class="na">proceed</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Around bbb ...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Throwable</span> <span class="n">throwable</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">throwable</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸ºäº†æ–¹ä¾¿çœ‹æ•ˆæœ,æˆ‘ä»¬æµ‹è¯•ç±»ä¸­ï¼Œåªè¦ Boy ç±»:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.sharpcj.aopdemo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.sharpcj.aopdemo.test1.Boy</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.sharpcj.aopdemo.test1.Girl</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.context.annotation.AnnotationConfigApplicationContext</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppTest</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">AnnotationConfigApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="n">AppConfig</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Boy</span> <span class="n">boy</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;boy&#34;</span><span class="o">,</span><span class="n">Boy</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Girl</span> <span class="n">girl</span> <span class="o">=</span> <span class="o">(</span><span class="n">Girl</span><span class="o">)</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;girl&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">boy</span><span class="o">.</span><span class="na">buy</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// girl.buy();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š
<img src="https://img2018.cnblogs.com/blog/758949/201905/758949-20190529225633682-474468038.png"
	
	
	
	loading="lazy"
	
		alt="img"
	
	
></p>
<p>ç»“æœæ˜¾è€Œæ˜“è§ã€‚æŒ‡çš„æ³¨æ„çš„æ˜¯ <code>@Around</code> ä¿®é¥°çš„ç¯ç»•é€šçŸ¥ç±»å‹ï¼Œæ˜¯å°†æ•´ä¸ªç›®æ ‡æ–¹æ³•å°è£…èµ·æ¥äº†ï¼Œåœ¨ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬ä¼ å…¥äº† <code>ProceedingJoinPoint</code> ç±»å‹çš„å‚æ•°ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯å¿…é¡»è¦æœ‰çš„ï¼Œå¹¶ä¸”éœ€è¦è°ƒç”¨ <code>ProceedingJoinPoint</code> çš„ <code>proceed()</code> æ–¹æ³•ã€‚ å¦‚æœæ²¡æœ‰è°ƒç”¨ è¯¥æ–¹æ³•ï¼Œæ‰§è¡Œç»“æœä¸º ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-erlang" data-lang="erlang"><span class="line"><span class="cl"><span class="nv">Around</span> <span class="n">aaa</span> <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="nv">Around</span> <span class="n">bbb</span> <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="nv">After</span> <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="nv">AfterReturning</span> <span class="p">...</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯è§ï¼Œå¦‚æœä¸è°ƒç”¨è¯¥å¯¹è±¡çš„ proceed() æ–¹æ³•ï¼Œè¡¨ç¤ºåŸç›®æ ‡æ–¹æ³•è¢«é˜»å¡è°ƒç”¨ï¼Œå½“ç„¶ä¹Ÿæœ‰å¯èƒ½ä½ çš„å®é™…éœ€æ±‚å°±æ˜¯è¿™æ ·ã€‚</p>
<h2 id="43-é€šè¿‡æ³¨è§£å£°æ˜åˆ‡ç‚¹è¡¨è¾¾å¼">4.3 é€šè¿‡æ³¨è§£å£°æ˜åˆ‡ç‚¹è¡¨è¾¾å¼</h2>
<p>å¦‚ä½ çœ‹åˆ°çš„ï¼Œä¸Šé¢æˆ‘ä»¬å†™çš„å¤šä¸ªé€šçŸ¥ä½¿ç”¨äº†ç›¸åŒçš„åˆ‡ç‚¹è¡¨è¾¾å¼ï¼Œå¯¹äºåƒè¿™æ ·é¢‘ç¹å‡ºç°çš„ç›¸åŒçš„è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>@Pointcut</code>æ³¨è§£å£°æ˜åˆ‡ç‚¹è¡¨è¾¾å¼ï¼Œç„¶åä½¿ç”¨è¡¨è¾¾å¼ï¼Œä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š
BuyAspectJ.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.sharpcj.aopdemo.test1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.aspectj.lang.ProceedingJoinPoint</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.aspectj.lang.annotation.*</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Aspect</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BuyAspectJ</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Pointcut</span><span class="o">(</span><span class="s">&#34;execution(* com.sharpcj.aopdemo.test1.IBuy.buy(..))&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">point</span><span class="o">(){}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Before</span><span class="o">(</span><span class="s">&#34;point()&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hehe</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;before ...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@After</span><span class="o">(</span><span class="s">&#34;point()&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">haha</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;After ...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@AfterReturning</span><span class="o">(</span><span class="s">&#34;point()&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">xixi</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;AfterReturning ...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Around</span><span class="o">(</span><span class="s">&#34;point()&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">xxx</span><span class="o">(</span><span class="n">ProceedingJoinPoint</span> <span class="n">pj</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Around aaa ...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">pj</span><span class="o">.</span><span class="na">proceed</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;Around bbb ...&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Throwable</span> <span class="n">throwable</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">throwable</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¨‹åºè¿è¡Œç»“æœæ²¡æœ‰å˜åŒ–ã€‚
è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Pointcut</span><span class="o">(</span><span class="s">&#34;execution(* com.sharpcj.aopdemo.test1.IBuy.buy(..))&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">point</span><span class="o">(){}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å£°æ˜äº†ä¸€ä¸ªåˆ‡ç‚¹è¡¨è¾¾å¼ï¼Œè¯¥æ–¹æ³• point çš„å†…å®¹å¹¶ä¸é‡è¦ï¼Œæ–¹æ³•åä¹Ÿä¸é‡è¦ï¼Œå®é™…ä¸Šå®ƒåªæ˜¯ä½œä¸ºä¸€ä¸ªæ ‡è¯†ï¼Œä¾›é€šçŸ¥ä½¿ç”¨ã€‚</p>
<h2 id="44-é€šè¿‡æ³¨è§£å¤„ç†é€šçŸ¥ä¸­çš„å‚æ•°">4.4 é€šè¿‡æ³¨è§£å¤„ç†é€šçŸ¥ä¸­çš„å‚æ•°</h2>
<p>ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬è¦è¿›è¡Œå¢å¼ºå¤„ç†çš„ç›®æ ‡æ–¹æ³•æ²¡æœ‰å‚æ•°ï¼Œä¸‹é¢æˆ‘ä»¬æ¥è¯´è¯´æœ‰å‚æ•°çš„æƒ…å†µï¼Œå¹¶ä¸”åœ¨å¢å¼ºå¤„ç†ä¸­ä½¿ç”¨è¯¥å‚æ•°ã€‚
ä¸‹é¢æˆ‘ä»¬ç»™æ¥å£å¢åŠ ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºè´­ä¹°æ‰€èŠ±çš„é‡‘é’±ã€‚é€šè¿‡AOP å¢å¼ºå¤„ç†ï¼Œå¦‚æœå¥³å­©ä¹°è¡£æœè¶…è¿‡äº† 68 å…ƒï¼Œå°±å¯ä»¥èµ é€ä¸€åŒè¢œå­ã€‚
æ›´æ”¹ä»£ç å¦‚ä¸‹ï¼š
IBuy.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.sharpcj.aopdemo.test1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IBuy</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="nf">buy</span><span class="o">(</span><span class="kt">double</span> <span class="n">price</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Girl.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">package</span> <span class="nx">com</span><span class="p">.</span><span class="nx">sharpcj</span><span class="p">.</span><span class="nx">aopdemo</span><span class="p">.</span><span class="nx">test1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">org</span><span class="p">.</span><span class="nx">springframework</span><span class="p">.</span><span class="nx">stereotype</span><span class="p">.</span><span class="nx">Component</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="kr">public</span> <span class="kr">class</span> <span class="nx">Girl</span> <span class="kr">implements</span> <span class="nx">IBuy</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kr">public</span> <span class="nb">String</span> <span class="nx">buy</span><span class="p">(</span><span class="nx">double</span> <span class="nx">price</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">System</span><span class="p">.</span><span class="nx">out</span><span class="p">.</span><span class="nx">println</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s2">&#34;å¥³å­©èŠ±äº†%så…ƒä¹°äº†ä¸€ä»¶æ¼‚äº®çš„è¡£æœ&#34;</span><span class="p">,</span> <span class="nx">price</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;è¡£æœ&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Boy.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-typescript" data-lang="typescript"><span class="line"><span class="cl"><span class="kr">package</span> <span class="nx">com</span><span class="p">.</span><span class="nx">sharpcj</span><span class="p">.</span><span class="nx">aopdemo</span><span class="p">.</span><span class="nx">test1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">org</span><span class="p">.</span><span class="nx">springframework</span><span class="p">.</span><span class="nx">stereotype</span><span class="p">.</span><span class="nx">Component</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="kr">public</span> <span class="kr">class</span> <span class="nx">Boy</span> <span class="kr">implements</span> <span class="nx">IBuy</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kr">public</span> <span class="nb">String</span> <span class="nx">buy</span><span class="p">(</span><span class="nx">double</span> <span class="nx">price</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">System</span><span class="p">.</span><span class="nx">out</span><span class="p">.</span><span class="nx">println</span><span class="p">(</span><span class="nb">String</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s2">&#34;ç”·å­©èŠ±äº†%så…ƒä¹°äº†ä¸€ä¸ªæ¸¸æˆæœº&#34;</span><span class="p">,</span> <span class="nx">price</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;æ¸¸æˆæœº&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å†çœ‹ BuyAspectJ ç±»ï¼Œæˆ‘ä»¬å°†ä¹‹å‰çš„é€šçŸ¥éƒ½æ³¨é‡Šæ‰ã€‚ç”¨ä¸€ä¸ªç¯ç»•é€šçŸ¥æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">package</span> <span class="n">com</span><span class="o">.</span><span class="n">sharpcj</span><span class="o">.</span><span class="n">aopdemo</span><span class="o">.</span><span class="n">test1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.aspectj.lang.ProceedingJoinPoint</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.aspectj.lang.annotation.</span><span class="o">*</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Aspect</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="n">public</span> <span class="k">class</span> <span class="nc">BuyAspectJ</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">/*</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Pointcut</span><span class="p">(</span><span class="s2">&#34;execution(* com.sharpcj.aopdemo.test1.IBuy.buy(..))&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">void</span> <span class="n">point</span><span class="p">(){}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Before</span><span class="p">(</span><span class="s2">&#34;point()&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">void</span> <span class="n">hehe</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">&#34;before ...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@After</span><span class="p">(</span><span class="s2">&#34;point()&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">void</span> <span class="n">haha</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">&#34;After ...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@AfterReturning</span><span class="p">(</span><span class="s2">&#34;point()&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">void</span> <span class="n">xixi</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">&#34;AfterReturning ...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Around</span><span class="p">(</span><span class="s2">&#34;point()&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">void</span> <span class="n">xxx</span><span class="p">(</span><span class="n">ProceedingJoinPoint</span> <span class="n">pj</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">&#34;Around aaa ...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">pj</span><span class="o">.</span><span class="n">proceed</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">&#34;Around bbb ...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">Throwable</span> <span class="n">throwable</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">throwable</span><span class="o">.</span><span class="n">printStackTrace</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Pointcut</span><span class="p">(</span><span class="s2">&#34;execution(String com.sharpcj.aopdemo.test1.IBuy.buy(double)) &amp;&amp; args(price) &amp;&amp; bean(girl)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">void</span> <span class="n">gif</span><span class="p">(</span><span class="n">double</span> <span class="n">price</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Around</span><span class="p">(</span><span class="s2">&#34;gif(price)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">String</span> <span class="n">hehe</span><span class="p">(</span><span class="n">ProceedingJoinPoint</span> <span class="n">pj</span><span class="p">,</span> <span class="n">double</span> <span class="n">price</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">pj</span><span class="o">.</span><span class="n">proceed</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">price</span> <span class="o">&gt;</span> <span class="mi">68</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">println</span><span class="p">(</span><span class="s2">&#34;å¥³å­©ä¹°è¡£æœè¶…è¿‡äº†68å…ƒï¼Œèµ é€ä¸€åŒè¢œå­&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="s2">&#34;è¡£æœå’Œè¢œå­&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">Throwable</span> <span class="n">throwable</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">throwable</span><span class="o">.</span><span class="n">printStackTrace</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;è¡£æœ&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å‰æ–‡æåˆ°ï¼Œå½“ä¸å…³å¿ƒæ–¹æ³•è¿”å›å€¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨ç¼–å†™åˆ‡ç‚¹æŒ‡ç¤ºå™¨çš„æ—¶å€™ä½¿ç”¨äº† <code>*</code> ï¼Œ å½“ä¸å…³å¿ƒæ–¹æ³•å‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>..</code>ã€‚ç°åœ¨å¦‚æœæˆ‘ä»¬éœ€è¦ä¼ å…¥å‚æ•°ï¼Œå¹¶ä¸”æœ‰è¿”å›å€¼çš„æ—¶å€™ï¼Œåˆ™éœ€è¦ä½¿ç”¨å¯¹åº”çš„ç±»å‹ã€‚åœ¨ç¼–å†™é€šçŸ¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦å£°æ˜å¯¹åº”çš„è¿”å›å€¼ç±»å‹å’Œå‚æ•°ç±»å‹ã€‚</p>
<p>æµ‹è¯•ç±»ï¼šAppTest.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.sharpcj.aopdemo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.sharpcj.aopdemo.test1.Boy</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">com.sharpcj.aopdemo.test1.Girl</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.context.annotation.AnnotationConfigApplicationContext</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppTest</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">AnnotationConfigApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="n">AppConfig</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Boy</span> <span class="n">boy</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;boy&#34;</span><span class="o">,</span><span class="n">Boy</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Girl</span> <span class="n">girl</span> <span class="o">=</span> <span class="o">(</span><span class="n">Girl</span><span class="o">)</span> <span class="n">context</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">&#34;girl&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">boyBought</span> <span class="o">=</span> <span class="n">boy</span><span class="o">.</span><span class="na">buy</span><span class="o">(</span><span class="n">35</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">girlBought</span> <span class="o">=</span> <span class="n">girl</span><span class="o">.</span><span class="na">buy</span><span class="o">(</span><span class="n">99</span><span class="o">.</span><span class="na">8</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;ç”·å­©ä¹°åˆ°äº†ï¼š&#34;</span> <span class="o">+</span> <span class="n">boyBought</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;å¥³å­©ä¹°åˆ°äº†ï¼š&#34;</span> <span class="o">+</span> <span class="n">girlBought</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æµ‹è¯•ç»“æœï¼š
<img src="https://img2018.cnblogs.com/blog/758949/201905/758949-20190529225709155-1683416178.png"
	
	
	
	loading="lazy"
	
		alt="img"
	
	
>
å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æˆåŠŸé€šè¿‡ AOP å®ç°äº†éœ€æ±‚ï¼Œå¹¶å°†ç»“æœæ‰“å°äº†å‡ºæ¥ã€‚</p>
<h2 id="45-é€šè¿‡æ³¨è§£é…ç½®ç»‡å…¥çš„æ–¹å¼">4.5 é€šè¿‡æ³¨è§£é…ç½®ç»‡å…¥çš„æ–¹å¼</h2>
<p>å‰é¢è¿˜æœ‰ä¸€ä¸ªé—ç•™é—®é¢˜ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬ç”¨æ³¨è§£ <code>@EnableAspectJAutoProxy()</code> å¯ç”¨Spring AOP çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»™å‚æ•° <code>proxyTargetClass</code> èµ‹å€¼ä¸º <code>true</code>,å¦‚æœæˆ‘ä»¬ä¸å†™å‚æ•°ï¼Œé»˜è®¤ä¸º falseã€‚è¿™ä¸ªæ—¶å€™è¿è¡Œç¨‹åºï¼Œç¨‹åºæŠ›å‡ºå¼‚å¸¸
<img src="https://img2018.cnblogs.com/blog/758949/201905/758949-20190529225724860-1448694025.png"
	
	
	
	loading="lazy"
	
		alt="img"
	
	
></p>
<p>è¿™æ˜¯ä¸€ä¸ªå¼ºåˆ¶ç±»å‹è½¬æ¢å¼‚å¸¸ã€‚ä¸ºä»€ä¹ˆä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸å‘¢ï¼Ÿæˆ–è®¸å·²ç»èƒ½å¤Ÿæƒ³åˆ°ï¼Œè¿™è·ŸSpring AOP åŠ¨æ€ä»£ç†çš„æœºåˆ¶æœ‰å…³ï¼Œè¿™ä¸ª <code>proxyTargetClass</code> å‚æ•°å†³å®šäº†ä»£ç†çš„æœºåˆ¶ã€‚å½“è¿™ä¸ªå‚æ•°ä¸º false æ—¶ï¼Œ
é€šè¿‡jdkçš„åŸºäºæ¥å£çš„æ–¹å¼è¿›è¡Œç»‡å…¥ï¼Œè¿™æ—¶å€™ä»£ç†ç”Ÿæˆçš„æ˜¯ä¸€ä¸ªæ¥å£å¯¹è±¡ï¼Œå°†è¿™ä¸ªæ¥å£å¯¹è±¡å¼ºåˆ¶è½¬æ¢ä¸ºå®ç°è¯¥æ¥å£çš„ä¸€ä¸ªç±»ï¼Œè‡ªç„¶å°±æŠ›å‡ºäº†ä¸Šè¿°ç±»å‹è½¬æ¢å¼‚å¸¸ã€‚
åä¹‹ï¼Œ<code>proxyTargetClass</code> ä¸º <code>true</code>ï¼Œåˆ™ä¼šä½¿ç”¨ cglib çš„åŠ¨æ€ä»£ç†æ–¹å¼ã€‚è¿™ç§æ–¹å¼çš„ç¼ºç‚¹æ˜¯æ‹“å±•ç±»çš„æ–¹æ³•è¢«<code>final</code>ä¿®é¥°æ—¶ï¼Œæ— æ³•è¿›è¡Œç»‡å…¥ã€‚
æµ‹è¯•ä¸€ä¸‹ï¼Œæˆ‘ä»¬å°† <code>proxyTargetClass</code> å‚æ•°è®¾ä¸º <code>true</code>ï¼ŒåŒæ—¶å°† Girl.java çš„ Buy æ–¹æ³•ç”¨ <code>final</code> ä¿®é¥°ï¼š
AppConfig.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="k">package</span> <span class="nn">com.sharpcj.aopdemo;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">import</span> <span class="nn">org.springframework.context.annotation.ComponentScan;</span>
</span></span><span class="line"><span class="cl"><span class="k">import</span> <span class="nn">org.springframework.context.annotation.Configuration;</span>
</span></span><span class="line"><span class="cl"><span class="k">import</span> <span class="nn">org.springframework.context.annotation.EnableAspectJAutoProxy;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="nd">@ComponentScan</span><span class="p">(</span><span class="n">basePackageClasses</span> <span class="p">=</span> <span class="p">{</span><span class="n">com</span><span class="p">.</span><span class="n">sharpcj</span><span class="p">.</span><span class="n">aopdemo</span><span class="p">.</span><span class="n">test1</span><span class="p">.</span><span class="n">IBuy</span><span class="p">.</span><span class="k">class</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="nd">@EnableAspectJAutoProxy</span><span class="p">(</span><span class="n">proxyTargetClass</span> <span class="p">=</span> <span class="k">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">AppConfig</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Girl.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.sharpcj.aopdemo.test1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Girl</span> <span class="kd">implements</span> <span class="n">IBuy</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">final</span> <span class="n">String</span> <span class="nf">buy</span><span class="o">(</span><span class="kt">double</span> <span class="n">price</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&#34;å¥³å­©èŠ±äº†%så…ƒä¹°äº†ä¸€ä»¶æ¼‚äº®çš„è¡£æœ&#34;</span><span class="o">,</span> <span class="n">price</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s">&#34;è¡£æœ&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ­¤æ—¶è¿è¡Œç»“æœï¼š
<img src="https://img2018.cnblogs.com/blog/758949/201905/758949-20190529225755992-1036671637.png"
	
	
	
	loading="lazy"
	
		alt="img"
	
	
></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„åˆ‡é¢å¹¶æ²¡æœ‰ç»‡å…¥ç”Ÿæ•ˆã€‚</p>
<h1 id="äº”é€šè¿‡-xml-é…ç½®æ–‡ä»¶å£°æ˜åˆ‡é¢">äº”ã€é€šè¿‡ XML é…ç½®æ–‡ä»¶å£°æ˜åˆ‡é¢</h1>
<p>å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»å±•ç¤ºäº†å¦‚ä½•é€šè¿‡æ³¨è§£é…ç½®å»å£°æ˜åˆ‡é¢ï¼Œä¸‹é¢æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨ XML æ–‡ä»¶ä¸­å£°æ˜åˆ‡é¢ã€‚ä¸‹é¢å…ˆåˆ—å‡º XML ä¸­å£°æ˜ AOP çš„å¸¸ç”¨å…ƒç´ ï¼š
<img src="https://img2018.cnblogs.com/blog/758949/201905/758949-20190529232014979-1838628294.png"
	
	
	
	loading="lazy"
	
		alt="img"
	
	
></p>
<p>æˆ‘ä»¬ä¾ç„¶å¯ä»¥ä½¿ç”¨ <code>&lt;aop:aspectj-autoproxy&gt;</code> å…ƒç´ ï¼Œä»–èƒ½å¤Ÿè‡ªåŠ¨ä»£ç†AspectJæ³¨è§£çš„é€šçŸ¥ç±»ã€‚</p>
<h2 id="51-xml-é…ç½®æ–‡ä»¶ä¸­åˆ‡ç‚¹æŒ‡ç¤ºå™¨">5.1 XML é…ç½®æ–‡ä»¶ä¸­åˆ‡ç‚¹æŒ‡ç¤ºå™¨</h2>
<p>åœ¨XMLé…ç½®æ–‡ä»¶ä¸­ï¼Œåˆ‡ç‚¹æŒ‡ç¤ºå™¨è¡¨è¾¾å¼ä¸é€šè¿‡æ³¨è§£é…ç½®çš„å†™æ³•åŸºæœ¬ä¸€è‡´ï¼ŒåŒºåˆ«å‰é¢æœ‰æåˆ°ï¼Œå³XMLæ–‡ä»¶ä¸­éœ€è¦ä½¿ç”¨ â€œandâ€ã€â€œorâ€ã€â€œnotâ€æ¥è¡¨ç¤º â€œä¸”â€ã€â€œæˆ–â€ã€â€œéâ€çš„å…³ç³»ã€‚</p>
<h2 id="52-xml-æ–‡ä»¶é…ç½®-aop-å®ä¾‹">5.2 XML æ–‡ä»¶é…ç½® AOP å®ä¾‹</h2>
<p>ä¸‹é¢æˆ‘ä»¬ä¸ä½¿ç”¨ä»»ä½•æ³¨è§£æ”¹é€ ä¸Šé¢çš„ä¾‹å­ï¼š
BuyAspectJ.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-csharp" data-lang="csharp"><span class="line"><span class="cl"><span class="n">package</span> <span class="n">com</span><span class="p">.</span><span class="n">sharpcj</span><span class="p">.</span><span class="n">aopdemo</span><span class="p">.</span><span class="n">test2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">org</span><span class="p">.</span><span class="n">aspectj</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="n">ProceedingJoinPoint</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">BuyAspectJ</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">hehe</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="p">.</span><span class="k">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&#34;before ...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">haha</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="p">.</span><span class="k">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&#34;After ...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">xixi</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="p">.</span><span class="k">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&#34;AfterReturning ...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">void</span> <span class="n">xxx</span><span class="p">(</span><span class="n">ProceedingJoinPoint</span> <span class="n">pj</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="p">.</span><span class="k">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&#34;Around aaa ...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">pj</span><span class="p">.</span><span class="n">proceed</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="p">.</span><span class="k">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&#34;Around bbb ...&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Throwable</span> <span class="n">throwable</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">throwable</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ Resource ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ aopdemo.xml ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span class="na">xmlns:aop=</span><span class="s">&#34;http://www.springframework.org/schema/aop&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;boy&#34;</span> <span class="na">class=</span><span class="s">&#34;com.sharpcj.aopdemo.test2.Boy&#34;</span><span class="nt">&gt;&lt;/bean&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;girl&#34;</span> <span class="na">class=</span><span class="s">&#34;com.sharpcj.aopdemo.test2.Girl&#34;</span><span class="nt">&gt;&lt;/bean&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;buyAspectJ&#34;</span> <span class="na">class=</span><span class="s">&#34;com.sharpcj.aopdemo.test2.BuyAspectJ&#34;</span><span class="nt">&gt;&lt;/bean&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;aop:config</span> <span class="na">proxy-target-class=</span><span class="s">&#34;true&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;aop:aspect</span> <span class="na">id=</span><span class="s">&#34;qiemian&#34;</span> <span class="na">ref=</span><span class="s">&#34;buyAspectJ&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;aop:before</span> <span class="na">pointcut=</span><span class="s">&#34;execution(* com.sharpcj.aopdemo.test2.IBuy.buy(..))&#34;</span> <span class="na">method=</span><span class="s">&#34;hehe&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;aop:after</span> <span class="na">pointcut=</span><span class="s">&#34;execution(* com.sharpcj.aopdemo.test2.IBuy.buy(..))&#34;</span> <span class="na">method=</span><span class="s">&#34;haha&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;aop:after-returning</span> <span class="na">pointcut=</span><span class="s">&#34;execution(* com.sharpcj.aopdemo.test2.IBuy.buy(..))&#34;</span> <span class="na">method=</span><span class="s">&#34;xixi&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;aop:around</span> <span class="na">pointcut=</span><span class="s">&#34;execution(* com.sharpcj.aopdemo.test2.IBuy.buy(..))&#34;</span> <span class="na">method=</span><span class="s">&#34;xxx&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/aop:aspect&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/aop:config&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/beans&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œåˆ†åˆ«å®šä¹‰äº†ä¸€ä¸ªåˆ‡é¢ï¼Œé‡Œé¢åŒ…å«å››ç§ç±»å‹çš„é€šçŸ¥ã€‚
æµ‹è¯•æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">ClassPathXmlApplicationContext</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassPathXmlApplicationContext</span><span class="o">(</span><span class="s">&#34;aopdemo.xml&#34;</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¥è·å– ApplicationContextï¼Œå…¶å®ƒä»£ç ä¸å˜ã€‚</p>
<h2 id="53-xml-æ–‡ä»¶é…ç½®å£°æ˜åˆ‡ç‚¹">5.3 XML æ–‡ä»¶é…ç½®å£°æ˜åˆ‡ç‚¹</h2>
<p>å¯¹äºé¢‘ç¹é‡å¤ä½¿ç”¨çš„åˆ‡ç‚¹è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å£°æ˜æˆåˆ‡ç‚¹ã€‚
é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼šaopdemo.xml</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span class="na">xmlns:aop=</span><span class="s">&#34;http://www.springframework.org/schema/aop&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;boy&#34;</span> <span class="na">class=</span><span class="s">&#34;com.sharpcj.aopdemo.test2.Boy&#34;</span><span class="nt">&gt;&lt;/bean&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;girl&#34;</span> <span class="na">class=</span><span class="s">&#34;com.sharpcj.aopdemo.test2.Girl&#34;</span><span class="nt">&gt;&lt;/bean&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;buyAspectJ&#34;</span> <span class="na">class=</span><span class="s">&#34;com.sharpcj.aopdemo.test2.BuyAspectJ&#34;</span><span class="nt">&gt;&lt;/bean&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;aop:config</span> <span class="na">proxy-target-class=</span><span class="s">&#34;true&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;aop:pointcut</span> <span class="na">id=</span><span class="s">&#34;apoint&#34;</span> <span class="na">expression=</span><span class="s">&#34;execution(* com.sharpcj.aopdemo.test2.IBuy.buy(..))&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;aop:aspect</span> <span class="na">id=</span><span class="s">&#34;qiemian&#34;</span> <span class="na">ref=</span><span class="s">&#34;buyAspectJ&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;aop:before</span> <span class="na">pointcut-ref=</span><span class="s">&#34;apoint&#34;</span> <span class="na">method=</span><span class="s">&#34;hehe&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;aop:after</span> <span class="na">pointcut-ref=</span><span class="s">&#34;apoint&#34;</span> <span class="na">method=</span><span class="s">&#34;haha&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;aop:after-returning</span> <span class="na">pointcut-ref=</span><span class="s">&#34;apoint&#34;</span> <span class="na">method=</span><span class="s">&#34;xixi&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;aop:around</span> <span class="na">pointcut-ref=</span><span class="s">&#34;apoint&#34;</span> <span class="na">method=</span><span class="s">&#34;xxx&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/aop:aspect&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/aop:config&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/beans&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="54-xmlæ–‡ä»¶é…ç½®ä¸ºé€šçŸ¥ä¼ é€’å‚æ•°">5.4 XMLæ–‡ä»¶é…ç½®ä¸ºé€šçŸ¥ä¼ é€’å‚æ•°</h2>
<p>BuyAspectJ.java</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="k">package</span> <span class="nn">com.sharpcj.aopdemo.test2;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">import</span> <span class="nn">org.aspectj.lang.ProceedingJoinPoint;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">class</span> <span class="nc">BuyAspectJ</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="n">String</span> <span class="n">hehe</span><span class="p">(</span><span class="n">ProceedingJoinPoint</span> <span class="n">pj</span><span class="p">,</span> <span class="n">double</span> <span class="n">price</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">pj</span><span class="p">.</span><span class="n">proceed</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">price</span> <span class="p">&gt;</span> <span class="m">68</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="p">.</span><span class="k">out</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s2">&#34;å¥³å­©ä¹°è¡£æœè¶…è¿‡äº†68å…ƒï¼Œèµ é€ä¸€åŒè¢œå­&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="s2">&#34;è¡£æœå’Œè¢œå­&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Throwable</span> <span class="n">throwable</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">throwable</span><span class="p">.</span><span class="n">printStackTrace</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;è¡£æœ&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>aopdemo.xml</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;beans</span> <span class="na">xmlns=</span><span class="s">&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span class="na">xmlns:aop=</span><span class="s">&#34;http://www.springframework.org/schema/aop&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;boy&#34;</span> <span class="na">class=</span><span class="s">&#34;com.sharpcj.aopdemo.test2.Boy&#34;</span><span class="nt">&gt;&lt;/bean&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;girl&#34;</span> <span class="na">class=</span><span class="s">&#34;com.sharpcj.aopdemo.test2.Girl&#34;</span><span class="nt">&gt;&lt;/bean&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&#34;buyAspectJ&#34;</span> <span class="na">class=</span><span class="s">&#34;com.sharpcj.aopdemo.test2.BuyAspectJ&#34;</span><span class="nt">&gt;&lt;/bean&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;aop:config</span> <span class="na">proxy-target-class=</span><span class="s">&#34;true&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;aop:pointcut</span> <span class="na">id=</span><span class="s">&#34;apoint&#34;</span> <span class="na">expression=</span><span class="s">&#34;execution(String com.sharpcj.aopdemo.test2.IBuy.buy(double)) and args(price) and bean(girl)&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;aop:aspect</span> <span class="na">id=</span><span class="s">&#34;qiemian&#34;</span> <span class="na">ref=</span><span class="s">&#34;buyAspectJ&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;aop:around</span> <span class="na">pointcut-ref=</span><span class="s">&#34;apoint&#34;</span> <span class="na">method=</span><span class="s">&#34;hehe&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/aop:aspect&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/aop:config&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/beans&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="55-xml-æ–‡ä»¶é…ç½®ç»‡å…¥çš„æ–¹å¼">5.5 Xml æ–‡ä»¶é…ç½®ç»‡å…¥çš„æ–¹å¼</h2>
<p>åŒæ³¨è§£é…ç½®ç±»ä¼¼,
CGlib ä»£ç†æ–¹å¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nl">aop:</span><span class="n">config</span> <span class="n">proxy</span><span class="o">-</span><span class="n">target</span><span class="o">-</span><span class="n">class</span><span class="o">=</span><span class="s">&#34;true&#34;</span><span class="o">&gt;</span> <span class="o">&lt;/</span><span class="nl">aop:</span><span class="n">config</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>JDK ä»£ç†æ–¹å¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-verilog" data-lang="verilog"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nl">aop:</span><span class="n">config</span> <span class="n">proxy</span><span class="o">-</span><span class="n">target</span><span class="o">-</span><span class="n">class</span><span class="o">=</span><span class="s">&#34;false&#34;</span><span class="o">&gt;</span> <span class="o">&lt;/</span><span class="nl">aop:</span><span class="n">config</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="å…­æ€»ç»“">å…­ã€æ€»ç»“</h1>
<p>æœ¬æ–‡ç®€å•è®°å½•äº† AOP çš„ç¼–ç¨‹æ€æƒ³ï¼Œç„¶åä»‹ç»äº† Spring ä¸­ AOP çš„ç›¸å…³æ¦‚å¿µï¼Œä»¥åŠé€šè¿‡æ³¨è§£æ–¹å¼å’ŒXMLé…ç½®æ–‡ä»¶ä¸¤ç§æ–¹å¼ä½¿ç”¨ Spring AOPè¿›è¡Œç¼–ç¨‹ã€‚ ç›¸æ¯”äº AspectJ çš„é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ŒSpring AOP ä¹Ÿæœ‰ä¸€äº›å±€é™æ€§ï¼Œä½†æ˜¯å·²ç»å¯ä»¥è§£å†³å¼€å‘ä¸­çš„ç»å¤§å¤šæ•°é—®é¢˜äº†ï¼Œå¦‚æœç¡®å®é‡åˆ°äº† Spring AOP è§£å†³ä¸äº†çš„åœºæ™¯ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥åœ¨ Spring ä¸­ä½¿ç”¨ AspectJ æ¥è§£å†³ã€‚</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/stack/tags/java/">java</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>åˆ«æ‰¯äº†ï¼Œæˆ‘æ˜¯æœ‰åº•çº¿çš„~</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/stack/p/spring%E4%BA%8B%E5%8A%A1/">
        
        

        <div class="article-details">
            <h2 class="article-title">springäº‹åŠ¡</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/stack/p/spring%E4%B8%AD%E7%9A%84%E5%BC%82%E6%AD%A5%E6%96%B9%E6%B3%95/">
        
        

        <div class="article-details">
            <h2 class="article-title">springä¸­çš„å¼‚æ­¥æ–¹æ³•</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/stack/p/java%E5%8F%8D%E7%BC%96%E8%AF%91/">
        
        

        <div class="article-details">
            <h2 class="article-title">javaåç¼–è¯‘</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/stack/p/java%E6%97%A5%E5%BF%97%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/">
        
        

        <div class="article-details">
            <h2 class="article-title">javaæ—¥å¿—åŸºæœ¬çŸ¥è¯†</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/stack/p/%E5%B8%B8%E7%94%A8jvm%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0/">
        
        

        <div class="article-details">
            <h2 class="article-title">å¸¸ç”¨JVMé…ç½®å‚æ•°</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2022 ç¾¡é±¼å…ˆç”Ÿçš„ç©ºé—´
    </section>
    
    <section class="powerby">
        
            ä¸é‚£ä¹ˆå¥½è¿‡çš„æ—¥å­é‡Œï¼Œè¦å­¦ä¼šæ¯å¤©ç»™è‡ªå·±æ‰¾ä¸€ä¸ªå¼€å¿ƒçš„ç†ç”±ï¼Œå“ªæ€•åªæ˜¯ï¼Œé˜³å…‰å¾ˆæš–ï¼Œç”µé‡å¾ˆæ»¡ã€‚ <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.13.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#11-ä»€ä¹ˆæ˜¯-aop">1.1 ä»€ä¹ˆæ˜¯ AOP</a></li>
    <li><a href="#12-ä¸ºä»€ä¹ˆéœ€è¦-aop">1.2 ä¸ºä»€ä¹ˆéœ€è¦ AOP</a></li>
    <li><a href="#13-aop-å®ç°åˆ†ç±»">1.3 AOP å®ç°åˆ†ç±»</a></li>
  </ol>

  <ol>
    <li><a href="#31-spring-aop-çš„ç‰¹ç‚¹">3.1 Spring AOP çš„ç‰¹ç‚¹</a></li>
    <li><a href="#32-spring-aop-çš„ç®€å•ä¾‹å­">3.2 Spring AOP çš„ç®€å•ä¾‹å­</a></li>
  </ol>

  <ol>
    <li><a href="#41-é€šè¿‡æ³¨è§£å£°æ˜åˆ‡ç‚¹æŒ‡ç¤ºå™¨">4.1 é€šè¿‡æ³¨è§£å£°æ˜åˆ‡ç‚¹æŒ‡ç¤ºå™¨</a></li>
    <li><a href="#42-é€šè¿‡æ³¨è§£å£°æ˜-5-ç§é€šçŸ¥ç±»å‹">4.2 é€šè¿‡æ³¨è§£å£°æ˜ 5 ç§é€šçŸ¥ç±»å‹</a></li>
    <li><a href="#43-é€šè¿‡æ³¨è§£å£°æ˜åˆ‡ç‚¹è¡¨è¾¾å¼">4.3 é€šè¿‡æ³¨è§£å£°æ˜åˆ‡ç‚¹è¡¨è¾¾å¼</a></li>
    <li><a href="#44-é€šè¿‡æ³¨è§£å¤„ç†é€šçŸ¥ä¸­çš„å‚æ•°">4.4 é€šè¿‡æ³¨è§£å¤„ç†é€šçŸ¥ä¸­çš„å‚æ•°</a></li>
    <li><a href="#45-é€šè¿‡æ³¨è§£é…ç½®ç»‡å…¥çš„æ–¹å¼">4.5 é€šè¿‡æ³¨è§£é…ç½®ç»‡å…¥çš„æ–¹å¼</a></li>
  </ol>

  <ol>
    <li><a href="#51-xml-é…ç½®æ–‡ä»¶ä¸­åˆ‡ç‚¹æŒ‡ç¤ºå™¨">5.1 XML é…ç½®æ–‡ä»¶ä¸­åˆ‡ç‚¹æŒ‡ç¤ºå™¨</a></li>
    <li><a href="#52-xml-æ–‡ä»¶é…ç½®-aop-å®ä¾‹">5.2 XML æ–‡ä»¶é…ç½® AOP å®ä¾‹</a></li>
    <li><a href="#53-xml-æ–‡ä»¶é…ç½®å£°æ˜åˆ‡ç‚¹">5.3 XML æ–‡ä»¶é…ç½®å£°æ˜åˆ‡ç‚¹</a></li>
    <li><a href="#54-xmlæ–‡ä»¶é…ç½®ä¸ºé€šçŸ¥ä¼ é€’å‚æ•°">5.4 XMLæ–‡ä»¶é…ç½®ä¸ºé€šçŸ¥ä¼ é€’å‚æ•°</a></li>
    <li><a href="#55-xml-æ–‡ä»¶é…ç½®ç»‡å…¥çš„æ–¹å¼">5.5 Xml æ–‡ä»¶é…ç½®ç»‡å…¥çš„æ–¹å¼</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/stack/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
